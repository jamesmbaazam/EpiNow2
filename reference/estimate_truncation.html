<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Estimates a truncation distribution from multiple snapshots of the same
data source over time. This distribution can then be used in regional_epinow,
epinow, and estimate_infections to adjust for truncated data. See here
for an example of using this approach on Covid-19 data in England. The
functionality offered by this function is now available in a more principled
manner in the epinowcast R package.
The model of truncation is as follows:
The truncation distribution is assumed to be discretised log normal with a mean and
standard deviation that is informed by the data.
The data set with the latest observations is adjusted for truncation using
the truncation distribution.
Earlier data sets are recreated by applying the truncation distribution to
the adjusted latest observations in the time period of the earlier data set. These
data sets are then compared to the earlier observations assuming a negative binomial
observation model with an additive noise term to deal with zero observations.


This model is then fit using stan with standard normal, or half normal,
prior for the mean, standard deviation, 1 over the square root of the over dispersion
and additive noise term.
This approach assumes that:
Current truncation is related to past truncation.
Truncation is a multiplicative scaling of underlying reported cases.
Truncation is log normally distributed.

"><title>Estimate Truncation of Observed Data — estimate_truncation • EpiNow2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Truncation of Observed Data — estimate_truncation"><meta property="og:description" content="
Estimates a truncation distribution from multiple snapshots of the same
data source over time. This distribution can then be used in regional_epinow,
epinow, and estimate_infections to adjust for truncated data. See here
for an example of using this approach on Covid-19 data in England. The
functionality offered by this function is now available in a more principled
manner in the epinowcast R package.
The model of truncation is as follows:
The truncation distribution is assumed to be discretised log normal with a mean and
standard deviation that is informed by the data.
The data set with the latest observations is adjusted for truncation using
the truncation distribution.
Earlier data sets are recreated by applying the truncation distribution to
the adjusted latest observations in the time period of the earlier data set. These
data sets are then compared to the earlier observations assuming a negative binomial
observation model with an additive noise term to deal with zero observations.


This model is then fit using stan with standard normal, or half normal,
prior for the mean, standard deviation, 1 over the square root of the over dispersion
and additive noise term.
This approach assumes that:
Current truncation is related to past truncation.
Truncation is a multiplicative scaling of underlying reported cases.
Truncation is log normally distributed.

"><meta property="og:image" content="epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-14-1.png"><meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@seabbs"><meta name="twitter:site" content="@cmmid_lshtm"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EpiNow2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-model-definitions">Model definitions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-model-definitions">
    <a class="dropdown-item" href="../articles/estimate_infections.html">estimate_infections()</a>
    <a class="dropdown-item" href="../articles/estimate_secondary.html">estimate_secondary()</a>
    <a class="dropdown-item" href="../articles/estimate_truncation.html">estimate_truncation()</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-case-studies">Case studies</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-case-studies">
    <a class="dropdown-item" href="../articles/case-studies.html">External case studies and use in the literature</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiforecasts/EpiNow2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Estimate Truncation of Observed Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/EpiNow2/blob/HEAD/R/estimate_truncation.R" class="external-link"><code>R/estimate_truncation.R</code></a></small>
      <div class="d-none name"><code>estimate_truncation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a>
Estimates a truncation distribution from multiple snapshots of the same
data source over time. This distribution can then be used in <code>regional_epinow</code>,
<code>epinow</code>, and <code>estimate_infections</code> to adjust for truncated data. See <a href="https://gist.github.com/seabbs/176b0c7f83eab1a7192a25b28bbd116a" class="external-link">here</a>
for an example of using this approach on Covid-19 data in England. The
functionality offered by this function is now available in a more principled
manner in the <a href="https://package.epinowcast.org/" class="external-link"><code>epinowcast</code> R package</a>.</p>
<p>The model of truncation is as follows:</p><ol><li><p>The truncation distribution is assumed to be discretised log normal with a mean and
standard deviation that is informed by the data.</p></li>
<li><p>The data set with the latest observations is adjusted for truncation using
the truncation distribution.</p></li>
<li><p>Earlier data sets are recreated by applying the truncation distribution to
the adjusted latest observations in the time period of the earlier data set. These
data sets are then compared to the earlier observations assuming a negative binomial
observation model with an additive noise term to deal with zero observations.</p></li>
</ol><p>This model is then fit using <code>stan</code> with standard normal, or half normal,
prior for the mean, standard deviation, 1 over the square root of the over dispersion
and additive noise term.</p>
<p>This approach assumes that:</p><ul><li><p>Current truncation is related to past truncation.</p></li>
<li><p>Truncation is a multiplicative scaling of underlying reported cases.</p></li>
<li><p>Truncation is log normally distributed.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_truncation</span><span class="op">(</span></span>
<span>  <span class="va">obs</span>,</span>
<span>  max_truncation <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  CrIs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>obs</dt>
<dd><p>A list of data frames each containing a date variable
and a confirm (integer) variable. Each data set should be a snapshot
of the reported data over time. All data sets must contain a complete vector
of dates.</p></dd>


<dt>max_truncation</dt>
<dd><p>Integer, defaults to 10. Maximum number of
days to include in the truncation distribution.</p></dd>


<dt>model</dt>
<dd><p>A compiled stan model to override the default model. May be
useful for package developers or those developing extensions.</p></dd>


<dt>CrIs</dt>
<dd><p>Numeric vector of credible intervals to calculate.</p></dd>


<dt>verbose</dt>
<dd><p>Logical, should model fitting progress be returned.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters to pass to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing: the summary parameters of the truncation distribution
(<code>dist</code>), the estimated CMF of the truncation distribution (<code>cmf</code>, can be used to adjusted
new data), a data frame containing the observed truncated data, latest observed data
and the adjusted for truncation observations (<code>obs</code>), a data frame containing the last
observed data (<code>last_obs</code>, useful for plotting and validation), the data used for fitting
(<code>data</code>) and the fit object (<code>fit</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># set number of cores to use</span></span></span>
<span class="r-in"><span><span class="va">old_opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get example case counts</span></span></span>
<span class="r-in"><span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">example_confirmed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define example truncation distribution (note not integer adjusted)</span></span></span>
<span class="r-in"><span><span class="va">trunc_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  mean <span class="op">=</span> <span class="fu"><a href="convert_to_logmean.html">convert_to_logmean</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  mean_sd <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fu"><a href="convert_to_logsd.html">convert_to_logsd</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sd_sd <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  max <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># apply truncation to example data</span></span></span>
<span class="r-in"><span><span class="va">construct_truncation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">index</span>, <span class="va">cases</span>, <span class="va">dist</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">dlnorm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">max</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">dist</span><span class="op">$</span><span class="va">mean</span>, <span class="va">dist</span><span class="op">$</span><span class="va">mean_sd</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">dist</span><span class="op">$</span><span class="va">sd</span>, <span class="va">dist</span><span class="op">$</span><span class="va">sd_sd</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cmf</span> <span class="op">&lt;-</span> <span class="va">cmf</span> <span class="op">/</span> <span class="va">cmf</span><span class="op">[</span><span class="va">dist</span><span class="op">$</span><span class="va">max</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">cmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">cmf</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">trunc_cases</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">.N</span> <span class="op">-</span> <span class="va">index</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">trunc_cases</span><span class="op">[</span><span class="op">(</span><span class="va">.N</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cmf</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">.N</span>, <span class="va">confirm</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">confirm</span> <span class="op">*</span> <span class="va">cmf</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">trunc_cases</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">construct_truncation</span>,</span></span>
<span class="r-in"><span>  cases <span class="op">=</span> <span class="va">reported_cases</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="va">trunc_dist</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit model to example data</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">estimate_truncation</span><span class="op">(</span><span class="va">example_data</span>,</span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">2000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the distribution</span></span></span>
<span class="r-in"><span><span class="va">est</span><span class="op">$</span><span class="va">dist</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mean_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># summary of the estimated truncation cmf (can be applied to new data)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">cmf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     index      mean      se_mean           sd  lower_90  lower_50  lower_20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    10 1.0000000 1.226280e-16 1.229601e-16 1.0000000 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     9 0.9896889 1.075600e-04 2.799872e-03 0.9846574 0.9880227 0.9893294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     8 0.9752521 2.348912e-04 6.136340e-03 0.9643087 0.9715124 0.9743944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     7 0.9545625 3.831812e-04 1.004978e-02 0.9370735 0.9483097 0.9529824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     6 0.9241144 5.497176e-04 1.448162e-02 0.8990795 0.9150072 0.9216233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     5 0.8779323 7.217210e-04 1.911491e-02 0.8456177 0.8654845 0.8741544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     4 0.8055017 8.623112e-04 2.301875e-02 0.7676057 0.7905808 0.8006204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     3 0.6879926 8.816843e-04 2.397265e-02 0.6497516 0.6721271 0.6819925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     2 0.4934859 6.087726e-04 1.832795e-02 0.4643281 0.4814682 0.4887787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     1 0.1938950 2.846655e-04 1.246762e-02 0.1741613 0.1855408 0.1902387</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        median  upper_20  upper_50  upper_90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: 1.0000000 1.0000000 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: 0.9899884 0.9906112 0.9915584 0.9937713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: 0.9758309 0.9771882 0.9793840 0.9843765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: 0.9554146 0.9576076 0.9612910 0.9697580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: 0.9250576 0.9282695 0.9337107 0.9465805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: 0.8788326 0.8830355 0.8905221 0.9083125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: 0.8061657 0.8112569 0.8206704 0.8432278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: 0.6880524 0.6931894 0.7036707 0.7276760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: 0.4931686 0.4975191 0.5049966 0.5250352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: 0.1932473 0.1963757 0.2018688 0.2147995</span>
<span class="r-in"><span><span class="co"># observations linked to truncation adjusted estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">obs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           date confirm last_confirm report_date mean se_mean  sd lower_90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: 2020-03-24    4751         4789  2020-04-01 4800       0  13     4780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: 2020-03-25    5163         5249  2020-04-01 5294       1  33     5244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: 2020-03-26    5049         5210  2020-04-01 5289       2  55     5206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: 2020-03-27    5804         6153  2020-04-01 6282       3  99     6131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: 2020-03-28    5345         5959  2020-04-01 6091       5 133     5884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: 2020-03-29    4860         5974  2020-04-01 6038       6 173     5763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: 2020-03-30    3474         5217  2020-04-01 5055       6 176     4774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: 2020-03-31    1721         4050  2020-04-01 3492       4 129     3277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: 2020-04-01     502         4053  2020-04-01 2599       3 165     2337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: 2020-03-29    5852         5974  2020-04-06 5913       0  16     5888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: 2020-03-30    5025         5217  2020-04-06 5152       1  32     5104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: 2020-03-31    3808         4050  2020-04-06 3989       1  42     3926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: 2020-04-01    3676         4053  2020-04-06 3978       2  62     3883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: 2020-04-02    4105         4782  2020-04-06 4677       3 102     4519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: 2020-04-03    3668         4668  2020-04-06 4557       4 130     4349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: 2020-04-04    3093         4585  2020-04-06 4501       5 157     4250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: 2020-04-05    2423         4805  2020-04-06 4916       6 182     4614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: 2020-04-06    1106         4316  2020-04-06 5727       8 365     5148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: 2020-04-03    4636         4668  2020-04-11 4684       0  13     4665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: 2020-04-04    4522         4585  2020-04-11 4636       1  29     4593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: 2020-04-05    4681         4805  2020-04-11 4904       1  51     4826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: 2020-04-06    4115         4316  2020-04-11 4454       2  70     4347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: 2020-04-07    3298         3599  2020-04-11 3758       3  82     3630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: 2020-04-08    2580         3039  2020-04-11 3205       3  92     3059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: 2020-04-09    2788         3836  2020-04-11 4057       5 141     3831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26: 2020-04-10    2156         4204  2020-04-11 4374       5 162     4106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27: 2020-04-11     789         3951  2020-04-11 4085       5 260     3673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28: 2020-04-13    4050         4050  2020-04-21 4092       0  11     4075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29: 2020-04-14    3089         3089  2020-04-21 3167       0  19     3138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30: 2020-04-15    2861         2861  2020-04-21 2997       1  31     2950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31: 2020-04-16    2491         2491  2020-04-21 2696       1  42     2631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32: 2020-04-17    3350         3350  2020-04-21 3817       3  83     3688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33: 2020-04-18    2793         2793  2020-04-21 3470       3  99     3312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34: 2020-04-19    2284         2284  2020-04-21 3323       4 116     3138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35: 2020-04-20    1291         1291  2020-04-21 2619       3  97     2458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36: 2020-04-21     302          302  2020-04-21 1563       2  99     1405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           date confirm last_confirm report_date mean se_mean  sd lower_90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_50 lower_20 median upper_20 upper_50 upper_90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     4791     4796   4799     4802     4808     4825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     5271     5283   5290     5298     5314     5354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     5252     5272   5284     5298     5324     5388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     6216     6252   6274     6297     6343     6455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     6002     6052   6081     6114     6175     6320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     5921     5990   6028     6070     6147     6331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     4936     5011   5049     5093     5168     5346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     3407     3459   3489     3521     3574     3706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     2486     2556   2597     2638     2705     2882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     5901     5907   5911     5915     5922     5943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:     5130     5142   5149     5157     5172     5210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:     3961     3976   3985     3995     4015     4063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:     3936     3960   3973     3988     4017     4088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:     4609     4648   4670     4695     4743     4854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:     4469     4521   4549     4581     4639     4778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:     4395     4461   4495     4535     4601     4760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:     4798     4870   4913     4957     5032     5218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:     5478     5632   5723     5813     5960     6350</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:     4675     4679   4682     4686     4692     4708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:     4617     4627   4633     4640     4654     4689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:     4869     4888   4899     4911     4936     4995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:     4407     4432   4448     4464     4497     4576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:     3703     3734   3752     3772     3810     3900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:     3143     3180   3200     3222     3263     3361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:     3962     4021   4052     4088     4148     4290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26:     4269     4333   4371     4410     4477     4643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27:     3908     4017   4082     4147     4252     4530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28:     4084     4088   4090     4093     4099     4113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29:     3154     3161   3165     3170     3179     3203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30:     2976     2987   2994     3002     3016     3053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31:     2667     2683   2692     2702     2722     2770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32:     3761     3793   3811     3832     3870     3961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33:     3403     3442   3464     3488     3532     3638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34:     3245     3294   3319     3349     3398     3515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35:     2556     2594   2617     2641     2681     2780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36:     1496     1537   1562     1587     1627     1734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_50 lower_20 median upper_20 upper_50 upper_90</span>
<span class="r-in"><span><span class="co"># validation plot of observations vs estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.estimate_infections.html">plot</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="estimate_truncation-1.png" alt="" width="864" height="864"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old_opts</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Joel Hellewell, Katharine Sherratt, Katelyn Gostic, Joe Hickson, Hamada S. Badr, Michael DeWitt, EpiForecasts, <a href="https://www.lshtm.ac.uk/aboutus/people/funk.sebastian" class="external-link">Sebastian Funk</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

